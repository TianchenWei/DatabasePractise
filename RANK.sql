SELECT	mid,
	tdate,amount,
	RANK() OVER (ORDER BY no DESC) AS rank
FROM 	movement;
 mid  |   tdate    | amount  | rank 
------+------------+---------+------
 1009 | 1999-01-18 | 5600.00 |    1
 1004 | 1999-01-11 | -100.00 |    2
 1007 | 1999-01-15 |  345.56 |    2
 1005 | 1999-01-12 |  145.50 |    4
 1008 | 1999-01-15 | 1230.00 |    5
 1001 | 1999-01-05 | 4000.00 |    5
 1000 | 1999-01-05 | 2300.00 |    7
 1006 | 1999-01-15 |   10.23 |    7
 1002 | 1999-01-08 | -223.45 |    7

SELECT 	mid,                                                   
	tdate,
	amount,
	DENSE_RANK() OVER (ORDER BY no DESC) AS rank
FROM movement;
 mid  |   tdate    | amount  | rank 
------+------------+---------+------
 1009 | 1999-01-18 | 5600.00 |    1
 1004 | 1999-01-11 | -100.00 |    2
 1007 | 1999-01-15 |  345.56 |    2
 1005 | 1999-01-12 |  145.50 |    3
 1008 | 1999-01-15 | 1230.00 |    4
 1001 | 1999-01-05 | 4000.00 |    4
 1000 | 1999-01-05 | 2300.00 |    5
 1006 | 1999-01-15 |   10.23 |    5
 1002 | 1999-01-08 | -223.45 |    5
(9 rows)
